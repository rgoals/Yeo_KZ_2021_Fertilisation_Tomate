[["nombre-de-fruits.html", "Chapitre 6 Nombre de fruits 6.1 Préparation des données 6.2 Fruits 1 6.3 Fruits 2 6.4 Fruits 3", " Chapitre 6 Nombre de fruits 6.1 Préparation des données Jeu de données rdt.csv qui contient différentes mesures dont les nombres de fruits, comptés à 3 reprises en cours de culture : fruit1 : 86 JAS, 52 JAR, semaine 8 AR fruit2 : 93 JAS, 59 JAR, semaine 9 AR fruit3 : 100 JAS, 66 JAR, semaine 10 AR. La question est de savoir si les différents types dengrais induisent des quantités de fruits significativement différentes. df &lt;- read_csv(&quot;data/rdt.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## bloc = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## fleur1 = col_double(), ## fruit1 = col_double(), ## fleur2 = col_double(), ## fruit2 = col_double(), ## fleur3 = col_double(), ## fruit3 = col_double(), ## taux_fruit = col_double(), ## nfruits_re_m2 = col_double(), ## taux_nou_5 = col_double(), ## taux_nou_6 = col_double(), ## taux_nou_7 = col_double(), ## rdt_kgha = col_double(), ## rdt_tha = col_double() ## ) df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, fruit1, fruit2, fruit3) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/fruits.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 7 ## id bloc traitement engrais fruit1 fruit2 fruit3 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 6.86 12.6 24.7 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 13.7 22.9 26.9 ## 3 15 3 T2 Fumier poulets 7.2 8 11.2 ## 4 20 4 T1 Fumier porcs 8 13 24.5 ## 5 26 5 T1 Fumier porcs 10.9 14.9 12 6.2 Fruits 1 6.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.2.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit1) %&gt;% select(id, engrais, bloc, fruit1, is.outlier, is.extreme) df_out ## # A tibble: 5 x 6 ## id engrais bloc fruit1 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 25 Temoin 5 16 TRUE FALSE ## 2 9 Fumier poulets 2 5 TRUE FALSE ## 3 27 Fumier poulets 5 12 TRUE TRUE ## 4 11 50% FPorcs + 50% Eng. Min. 2 18.5 TRUE FALSE ## 5 18 50% FPoulets + 50% Eng. Min. 3 25.7 TRUE FALSE Il y a une observation aberrante extrême. Tous les outliers exclus pour améliorer la distribution. df &lt;- df %&gt;% filter(! id %in% df_out$id) #filter(id != 27) 6.2.3 Le modèle ANOVA lm1 &lt;- lm(fruit1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: fruit1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 131.58 5 3.2452 0.02763 * ## Residuals 154.08 19 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 En début de nouaison, il y aurait une différence significative entre les effets dau moins 2 engrais sur le Nombre de fruits des plants. Mais vérifions les conditions de validité de lANOVA. 6.2.4 Indépendance des résidus plot(lm1, 1) 6.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.957 0.349 6.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 19 1.29 0.308 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; différence deffet sur le Nombre de fruits des plants entre au moins deux engrais à cette date. 6.2.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = fruit1 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 6.02800 ## Fumier poulets - Temoin == 0 3.47667 ## Engrais mineral - Temoin == 0 3.51400 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.76500 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 7.12750 ## Fumier poulets - Fumier porcs == 0 -2.55133 ## Engrais mineral - Fumier porcs == 0 -2.51400 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 -3.26300 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.09950 ## Engrais mineral - Fumier poulets == 0 0.03733 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.71167 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 3.65083 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 -0.74900 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 3.61350 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 4.36250 ## Std. Error ## Fumier porcs - Temoin == 0 1.91030 ## Fumier poulets - Temoin == 0 2.17497 ## Engrais mineral - Temoin == 0 1.91030 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.01363 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.01363 ## Fumier poulets - Fumier porcs == 0 2.07967 ## Engrais mineral - Fumier porcs == 0 1.80105 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.91030 ## Engrais mineral - Fumier poulets == 0 2.07967 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.17497 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.17497 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.01363 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 3.156 0.0502 ## Fumier poulets - Temoin == 0 1.598 0.6080 ## Engrais mineral - Temoin == 0 1.840 0.4647 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 1.373 0.7408 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.540 0.0227 ## Fumier poulets - Fumier porcs == 0 -1.227 0.8178 ## Engrais mineral - Fumier porcs == 0 -1.396 0.7280 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 -1.708 0.5418 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.576 0.9915 ## Engrais mineral - Fumier poulets == 0 0.018 1.0000 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.327 0.9994 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 1.679 0.5596 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 -0.392 0.9986 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.892 0.4352 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.166 0.2966 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 6.2.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 6.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 6.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 6.2.11 Associer les moyennes et les écart-types pour le rapport fruit1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit1_moy, &quot;tab/fruit1_moyennes.csv&quot;) fruit1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 4 3.71 3.10 a ## 2 Fumier porcs 5 9.74 2.49 ab ## 3 Fumier poulets 3 7.19 0.32 ab ## 4 Engrais mineral 5 7.22 3.18 ab ## 5 50% FPorcs + 50% Eng. Min. 4 6.48 3.57 ab ## 6 50% FPoulets + 50% Eng. Min. 4 10.8 2.70 b 6.2.12 Graphe avec les comparaisons ggplot(fruit1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 12) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.3 Fruits 2 df &lt;- df_original 6.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.3.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit2) %&gt;% select(id, engrais, bloc, fruit2, is.outlier, is.extreme) df_out ## # A tibble: 2 x 6 ## id engrais bloc fruit2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 2 Fumier porcs 1 24 TRUE FALSE ## 2 18 50% FPoulets + 50% Eng. Min. 3 43.2 TRUE TRUE Il y a une observation aberrante extrême. Exclue pour améliorer la distribution. df &lt;- df %&gt;% filter(id != 18) #filter(! id %in% df_out$id) 6.3.3 Le modèle ANOVA lm2 &lt;- lm(fruit2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: fruit2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 376.77 5 2.9331 0.03429 * ## Residuals 590.88 23 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage, au moins deux types dengrais ont des effets significativement différents sur le Nombre de fruits des plants. Mais vérifions les conditions de validité de lANOVA. 6.3.4 Indépendance des résidus plot(lm2, 1) 6.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.986 0.960 6.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 23 1.01 0.434 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 6.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = fruit2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 6.108 ## Fumier poulets - Temoin == 0 1.918 ## Engrais mineral - Temoin == 0 6.980 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 7.034 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 11.359 ## Fumier poulets - Fumier porcs == 0 -4.190 ## Engrais mineral - Fumier porcs == 0 0.872 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.926 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 5.251 ## Engrais mineral - Fumier poulets == 0 5.062 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 5.116 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 9.441 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.054 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 4.379 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 4.325 ## Std. Error ## Fumier porcs - Temoin == 0 3.206 ## Fumier poulets - Temoin == 0 3.206 ## Engrais mineral - Temoin == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.400 ## Fumier poulets - Fumier porcs == 0 3.206 ## Engrais mineral - Fumier porcs == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 3.400 ## Engrais mineral - Fumier poulets == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 3.400 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 3.400 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 3.400 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 1.905 0.4237 ## Fumier poulets - Temoin == 0 0.598 0.9901 ## Engrais mineral - Temoin == 0 2.177 0.2853 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.194 0.2778 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.341 0.0297 ## Fumier poulets - Fumier porcs == 0 -1.307 0.7781 ## Engrais mineral - Fumier porcs == 0 0.272 0.9998 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.289 0.9997 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.544 0.6405 ## Engrais mineral - Fumier poulets == 0 1.579 0.6193 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.596 0.6089 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.777 0.0975 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.017 1.0000 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.288 0.7882 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.272 0.7965 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 . ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 6.3.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 6.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 6.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 6.3.11 Associer les moyennes et les écart-types pour le rapport fruit2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit2_moy, &quot;tab/fruit2_moyennes.csv&quot;) fruit2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 10.4 7.18 a ## 2 Fumier porcs 5 16.5 4.45 ab ## 3 Fumier poulets 5 12.3 2.86 ab ## 4 Engrais mineral 5 17.4 4.56 ab ## 5 50% FPorcs + 50% Eng. Min. 5 17.4 6.47 ab ## 6 50% FPoulets + 50% Eng. Min. 4 21.8 2.73 b 6.3.12 Graphe avec les comparaisons ggplot(fruit2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 25) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.4 Fruits 3 df &lt;- df_original 6.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit3)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.4.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit3) %&gt;% select(id, engrais, bloc, fruit3, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id engrais bloc fruit3 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 15 Fumier poulets 3 11.2 TRUE FALSE ## 2 4 Engrais mineral 1 28 TRUE FALSE ## 3 17 50% FPorcs + 50% Eng. Min. 3 12 TRUE FALSE Il ny pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 6.4.3 Le modèle ANOVA lm3 &lt;- lm(fruit3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: fruit3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 606.08 5 2.0866 0.1023 ## Residuals 1394.25 24 Il ny aurait pas deffets significativement différents sur le Nombre de fruits des plants à cette date entre les types dengrais. Mais vérifions les conditions de validité de lANOVA. 6.4.4 Indépendance des résidus plot(lm3, 1) 6.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.943 0.112 6.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 1.00 0.437 On retient que la conclusion de lANOVA peut être considérée valide. Affichons quand même les comparaisons par paires. Autre tentative avec le non paramétrique : df %&gt;% kruskal_test(fruit3 ~ engrais) ## # A tibble: 1 x 6 ## .y. n statistic df p method ## * &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 fruit3 30 8.18 5 0.146 Kruskal-Wallis 6.4.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 6.4.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 6.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 6.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 6.4.11 Associer les moyennes et les écart-types pour le rapport fruit3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit3_moy, &quot;tab/fruit3_moyennes.csv&quot;) fruit3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 16.6 3.62 a ## 2 Fumier porcs 5 23.7 11.2 a ## 3 Fumier poulets 5 19.6 5.11 a ## 4 Engrais mineral 5 21.5 4.01 a ## 5 50% FPorcs + 50% Eng. Min. 5 23.5 6.81 a ## 6 50% FPoulets + 50% Eng. Min. 5 31.1 11.0 a 6.4.12 Graphe avec les comparaisons ggplot(fruit3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 35) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.4.13 Évolution du nombre de fruits dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;fruit&quot;, fruit1, fruit2, fruit3) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;fruit1&quot;] &lt;- &quot;52 JAR&quot; df$temps[df$temps == &quot;fruit2&quot;] &lt;- &quot;59 JAR&quot; df$temps[df$temps == &quot;fruit3&quot;] &lt;- &quot;66 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;fruit&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/fruit_moy_temps.csv&quot;) df_ic ## temps engrais N fruit sd se ci ## 1 52 JAR Temoin 5 6.168 6.115690 2.735020 7.593633 ## 2 52 JAR Fumier porcs 5 9.738 2.488739 1.112998 3.090177 ## 3 52 JAR Fumier poulets 5 7.712 2.587222 1.157041 3.212461 ## 4 52 JAR Engrais mineral 5 7.224 3.174828 1.419826 3.942069 ## 5 52 JAR 50% FPorcs + 50% Eng. Min. 5 8.880 6.201447 2.773372 7.700114 ## 6 52 JAR 50% FPoulets + 50% Eng. Min. 5 13.812 7.050023 3.152866 8.753759 ## 7 59 JAR Temoin 5 10.406 7.174621 3.208588 8.908468 ## 8 59 JAR Fumier porcs 5 16.514 4.450357 1.990260 5.525848 ## 9 59 JAR Fumier poulets 5 12.324 2.855176 1.276874 3.545169 ## 10 59 JAR Engrais mineral 5 17.386 4.560809 2.039656 5.662993 ## 11 59 JAR 50% FPorcs + 50% Eng. Min. 5 17.440 6.473589 2.895077 8.038022 ## 12 59 JAR 50% FPoulets + 50% Eng. Min. 5 26.052 9.872767 4.415235 12.258659 ## 13 66 JAR Temoin 5 16.614 3.619528 1.618702 4.494237 ## 14 66 JAR Fumier porcs 5 23.746 11.220654 5.018029 13.932282 ## 15 66 JAR Fumier poulets 5 19.554 5.105069 2.283056 6.338780 ## 16 66 JAR Engrais mineral 5 21.520 4.006495 1.791759 4.974720 ## 17 66 JAR 50% FPorcs + 50% Eng. Min. 5 23.534 6.813280 3.046991 8.459804 ## 18 66 JAR 50% FPoulets + 50% Eng. Min. 5 31.132 11.001051 4.919820 13.659609 ggplot(df_ic, aes(x = temps, y = fruit, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Nombre de fruits&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "]]
