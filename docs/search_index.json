[["index.html", "A Minimal Book Example Chapitre 1 Présentation du projet 1.1 Déroulement 1.2 Objectifs de recherche 1.3 Les librairies", " A Minimal Book Example ZCO, Agronome, PhD. 2021-08-30 Chapitre 1 Présentation du projet 1.1 Déroulement Stage L3 avec essai de fertilisation au champ. Fin novembre 2020 à mars 2021. Dispositif expérimental en bloc de Fisher. 6 traitements, 5 répétitions. T0 : Témoin sans engrais T1 : Fumier de porcs T2 : Fumier de poulets T3 : Engrais mineral T4 : Combinaison 50% Fumier de Porcs + 50% Engrais Minéral T5 : Combinaison 50% Fumier de Poulets + 50% Engrais Minéral Mesures effectuées sur les 4 plants centraux le même jour pour chaque paramètre, en 3 ou 4 séances. 1.2 Objectifs de recherche Savoir si les différents types dengrais induisent : des augmentations de hauteur de plants significativement différentes des augmentations de diamètre des plants significativement différentes des nombres de feuilles significativement différents des nombres de fleurs significativement différents des nombres de fruits significativement différents ou des rendement tomate significativement différents. Nous souhaitons évaluer si ces différents engrais apportent une plus value comparée au témoin; surtout si les effets diffèrent dun type dengrais à lautre sur les paramètres végétatifs et/ou de rendement de la culture de tomate. 1.3 Les librairies library(tidyverse) # pour la manipulation et la visualisation des données library(ggpubr) # pour créer facilement des graphiques prêts à la publication library(rstatix) # contient des fonctions R facilitant les analyses statistiques library(Rmisc) # summarySE() library(agricolae) # SNK.test() "],["hauteur-des-plants.html", "Chapitre 2 Hauteur des plants 2.1 Préparation des données 2.2 Hauteur 1 2.3 Hauteur 2 2.4 Hauteur 3 2.5 Hauteur 4", " Chapitre 2 Hauteur des plants 2.1 Préparation des données Jeu de données veg.csv qui contient différentes mesures dont les hauteurs des plants de tomate, mesurées à 4 reprises : haut1 : 55 JAS, 21 JAR, semaine 3 AR haut2 : 69 JAS, 35 JAR, semaine 5 AR haut3 : 76 JAS, 42 JAR, semaine 6 AR haut4 : 83 JAS, 49 JAR, semaine 7 AR. La question est de savoir si les différents types dengrais induisent des hauteurs ou augmentations de hauteur de plants significativement différentes. df &lt;- read_csv(&quot;data/veg.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## .default = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## projet = col_character(), ## site = col_character(), ## date_semis = col_date(format = &quot;&quot;), ## date_repiquage = col_date(format = &quot;&quot;), ## period_repiq = col_character(), ## date_fert_1 = col_date(format = &quot;&quot;), ## period_fert1 = col_character(), ## date_1 = col_date(format = &quot;&quot;), ## period_d1 = col_character(), ## date_2 = col_date(format = &quot;&quot;), ## period_d2 = col_character(), ## date_fert_2 = col_date(format = &quot;&quot;), ## period_fert2 = col_character(), ## date_3 = col_date(format = &quot;&quot;), ## period_d3 = col_character(), ## date_4 = col_date(format = &quot;&quot;), ## period_d4 = col_character(), ## date_5 = col_date(format = &quot;&quot;) ## # ... with 10 more columns ## ) ## i Use `spec()` for the full column specifications. df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, haut1, haut2, haut3, haut4) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/hauteurs.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 8 ## id bloc traitement engrais haut1 haut2 haut3 haut4 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 12.4 22.5 26.8 33.2 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 27.4 36.2 39.5 45.3 ## 3 15 3 T2 Fumier poulets 17.4 22.6 26.2 30.6 ## 4 20 4 T1 Fumier porcs 15.9 29.9 34.6 37.4 ## 5 26 5 T1 Fumier porcs 19.9 34 35.9 37.9 2.2 Hauteur 1 2.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = haut1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 2.2.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(haut1) %&gt;% select(id, engrais, bloc, haut1, is.outlier, is.extreme) df_out ## [1] id engrais bloc haut1 is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 2.2.3 Le modèle ANOVA lm1 &lt;- lm(haut1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: haut1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 49.23 5 0.6646 0.6538 ## Residuals 355.56 24 À la semaine 3 après le repiquage (21 JAR), il ne serait pas encore possible détablir des différences significatives entre les effets des traitements sur les hauteurs des plants. Mais vérifions dabord les conditions de validité de lANOVA. 2.2.4 Indépendance des résidus plot(lm1, 1) 2.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.968 0.498 2.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.877 0.511 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; Pas de différence significative deffet sur la hauteur des plants à cette date entre les engrais. 2.2.7 Comparaisons par paires Tests post-hoc de comparaisons par paires entre les groupes (ici, les engrais) - aux fins du rapport de stage. cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 2.2.8 Graphe des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 2.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 2.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 2.2.11 Associer les moyennes et les écart-types pour le rapport haut1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(haut1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(haut1_moy, &quot;tab/hauteur1_moyennes.csv&quot;) haut1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 17.1 3.17 a ## 2 Fumier porcs 5 18.1 2.65 a ## 3 Fumier poulets 5 20.1 5.81 a ## 4 Engrais mineral 5 20.2 3.70 a ## 5 50% FPorcs + 50% Eng. Min. 5 20.7 1.76 a ## 6 50% FPoulets + 50% Eng. Min. 5 20.0 4.61 a 2.2.12 Graphe avec les comparaisons ggplot(haut1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 25) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 2.3 Hauteur 2 df &lt;- df_original 2.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = haut2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 2.3.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(haut2) %&gt;% select(id, engrais, bloc, haut2, is.outlier, is.extreme) df_out ## # A tibble: 5 x 6 ## id engrais bloc haut2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 1 Temoin 1 18 TRUE TRUE ## 2 7 Temoin 2 30.2 TRUE TRUE ## 3 11 50% FPorcs + 50% Eng. Min. 2 37.9 TRUE FALSE ## 4 23 50% FPorcs + 50% Eng. Min. 4 27.5 TRUE TRUE ## 5 6 50% FPoulets + 50% Eng. Min. 1 27.3 TRUE FALSE Il y a 3 observation classées aberrantes et extrêmes. Elles nont pas été exclues ! #df &lt;- df %&gt;% filter(!id %in% c(1, 7, 23)) #filter(! id %in% df_out$id) # 2.3.3 Le modèle ANOVA lm2 &lt;- lm(haut2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: haut2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 357.45 5 4.3551 0.005811 ** ## Residuals 393.96 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage (35 JAR), au moins deux types dengrais ont des effets très significativement différents sur les hauteurs des plants. Mais vérifions les conditions de validité de lANOVA. 2.3.4 Indépendance des résidus plot(lm2, 1) 2.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.950 0.165 2.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 1.09 0.392 On retiendra que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 2.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = haut2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 7.466 ## Fumier poulets - Temoin == 0 4.732 ## Engrais mineral - Temoin == 0 8.556 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 10.118 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 9.348 ## Fumier poulets - Fumier porcs == 0 -2.734 ## Engrais mineral - Fumier porcs == 0 1.090 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 2.652 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.882 ## Engrais mineral - Fumier poulets == 0 3.824 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 5.386 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 4.616 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 1.562 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.792 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 -0.770 ## Std. Error ## Fumier porcs - Temoin == 0 2.562 ## Fumier poulets - Temoin == 0 2.562 ## Engrais mineral - Temoin == 0 2.562 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.562 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.562 ## Fumier poulets - Fumier porcs == 0 2.562 ## Engrais mineral - Fumier porcs == 0 2.562 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 2.562 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.562 ## Engrais mineral - Fumier poulets == 0 2.562 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.562 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.562 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 2.562 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 2.562 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.562 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 2.914 0.07275 ## Fumier poulets - Temoin == 0 1.847 0.45672 ## Engrais mineral - Temoin == 0 3.339 0.02906 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.949 0.00698 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.648 0.01419 ## Fumier poulets - Fumier porcs == 0 -1.067 0.88954 ## Engrais mineral - Fumier porcs == 0 0.425 0.99799 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.035 0.90135 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.734 0.97552 ## Engrais mineral - Fumier poulets == 0 1.492 0.67213 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.102 0.31957 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 1.801 0.48348 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.610 0.98928 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.309 0.99957 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 -0.300 0.99963 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 * ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ** ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 2.3.8 Graphe des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) Il faut simplement noter que pour toute paire de comparaison, la différence est significative seulement si le segment de droite ne croise pas le ligne verticale en pointillés (le zéro). 2.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;b&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 2.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral b ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 2.3.11 Associer les moyennes et les écart-types pour le rapport haut2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(haut2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(haut2_moy, &quot;tab/hauteur2_moyennes.csv&quot;) haut2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 24.1 4.32 a ## 2 Fumier porcs 5 31.6 2.04 ab ## 3 Fumier poulets 5 28.8 6.25 ab ## 4 Engrais mineral 5 32.7 2.45 b ## 5 50% FPorcs + 50% Eng. Min. 5 34.2 3.95 b ## 6 50% FPoulets + 50% Eng. Min. 5 33.5 3.87 b 2.3.12 Graphe avec les comparaisons ggplot(haut2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 40) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 2.4 Hauteur 3 df &lt;- df_original 2.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = haut3)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 2.4.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(haut3) %&gt;% select(id, engrais, bloc, haut3, is.outlier, is.extreme) df_out ## # A tibble: 4 x 6 ## id engrais bloc haut3 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 1 Temoin 1 22.6 TRUE TRUE ## 2 7 Temoin 2 31.6 TRUE FALSE ## 3 10 Engrais mineral 2 28.7 TRUE FALSE ## 4 6 50% FPoulets + 50% Eng. Min. 1 33.7 TRUE FALSE Il y a une observation aberrante et extrême. Mais elle nest pas écartée. #df &lt;- df %&gt;% filter(id != 1) # filter(! id %in% df_out$id) 2.4.3 Le modèle ANOVA lm3 &lt;- lm(haut3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: haut3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 341.48 5 4.0921 0.007906 ** ## Residuals 400.55 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 6 après le repiquage, au moins deux types dengrais ont des effets très significativement différents sur les hauteurs des plants. Mais vérifions les conditions de validité de lANOVA. 2.4.4 Indépendance des résidus plot(lm3, 1) 2.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.970 0.533 2.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 1.52 0.222 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 2.4.7 Comparaisons par paires cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = haut3 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 7.490 ## Fumier poulets - Temoin == 0 4.746 ## Engrais mineral - Temoin == 0 7.620 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 9.164 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 10.194 ## Fumier poulets - Fumier porcs == 0 -2.744 ## Engrais mineral - Fumier porcs == 0 0.130 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.674 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.704 ## Engrais mineral - Fumier poulets == 0 2.874 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 4.418 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 5.448 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 1.544 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 2.574 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.030 ## Std. Error ## Fumier porcs - Temoin == 0 2.584 ## Fumier poulets - Temoin == 0 2.584 ## Engrais mineral - Temoin == 0 2.584 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.584 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.584 ## Fumier poulets - Fumier porcs == 0 2.584 ## Engrais mineral - Fumier porcs == 0 2.584 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 2.584 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.584 ## Engrais mineral - Fumier poulets == 0 2.584 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.584 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.584 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 2.584 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 2.584 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.584 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 2.899 0.07513 ## Fumier poulets - Temoin == 0 1.837 0.46247 ## Engrais mineral - Temoin == 0 2.949 0.06754 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.547 0.01810 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.945 0.00713 ## Fumier poulets - Fumier porcs == 0 -1.062 0.89144 ## Engrais mineral - Fumier porcs == 0 0.050 1.00000 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.648 0.98590 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.047 0.89719 ## Engrais mineral - Fumier poulets == 0 1.112 0.87149 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.710 0.53878 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.109 0.31628 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.598 0.99021 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.996 0.91466 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.399 0.99853 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 . ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 * ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 ** ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 2.4.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 2.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 2.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 2.4.11 Associer les moyennes et les écart-types pour le rapport haut3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(haut3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(haut3_moy, &quot;tab/hauteur3_moyennes.csv&quot;) haut3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 27.9 3.28 a ## 2 Fumier porcs 5 35.4 1.37 ab ## 3 Fumier poulets 5 32.6 6.80 ab ## 4 Engrais mineral 5 35.5 4.32 ab ## 5 50% FPorcs + 50% Eng. Min. 5 37.0 3.98 b ## 6 50% FPoulets + 50% Eng. Min. 5 38.1 2.61 b 2.4.12 Graphe avec les comparaisons ggplot(haut3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 40) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 2.5 Hauteur 4 df &lt;- df_original 2.5.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = haut4)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 2.5.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(haut4) %&gt;% select(id, engrais, bloc, haut4, is.outlier, is.extreme) df_out ## # A tibble: 1 x 6 ## id engrais bloc haut4 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 6 50% FPoulets + 50% Eng. Min. 1 36.9 TRUE FALSE Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 2.5.3 Le modèle ANOVA lm4 &lt;- lm(haut4 ~ engrais, data = df) Anova(lm4) ## Anova Table (Type II tests) ## ## Response: haut4 ## Sum Sq Df F value Pr(&gt;F) ## engrais 355.79 5 4.6772 0.004022 ** ## Residuals 365.13 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 7 après le repiquage, au moins deux types dengrais ont des effets très significativement différents sur les hauteurs des plants. Mais vérifions les conditions de validité de lANOVA. 2.5.4 Indépendance des résidus plot(lm4, 1) 2.5.5 Normalité des résidus plot(lm4, 2) shapiro_test(residuals(lm4)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm4) 0.970 0.529 2.5.6 Homogénéité des variances plot(lm4, 3) levene_test(residuals(lm4) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.722 0.613 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 2.5.7 Comparaisons par paires cm &lt;- multcomp::glht(lm4, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = haut4 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 7.424 ## Fumier poulets - Temoin == 0 4.628 ## Engrais mineral - Temoin == 0 8.412 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 8.944 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 10.376 ## Fumier poulets - Fumier porcs == 0 -2.796 ## Engrais mineral - Fumier porcs == 0 0.988 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.520 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.952 ## Engrais mineral - Fumier poulets == 0 3.784 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 4.316 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 5.748 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.532 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.964 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.432 ## Std. Error ## Fumier porcs - Temoin == 0 2.467 ## Fumier poulets - Temoin == 0 2.467 ## Engrais mineral - Temoin == 0 2.467 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.467 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.467 ## Fumier poulets - Fumier porcs == 0 2.467 ## Engrais mineral - Fumier porcs == 0 2.467 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 2.467 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.467 ## Engrais mineral - Fumier poulets == 0 2.467 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.467 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.467 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 2.467 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 2.467 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.467 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 3.009 0.05958 ## Fumier poulets - Temoin == 0 1.876 0.43987 ## Engrais mineral - Temoin == 0 3.410 0.02474 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.626 0.01501 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 4.206 0.00369 ## Fumier poulets - Fumier porcs == 0 -1.133 0.86261 ## Engrais mineral - Fumier porcs == 0 0.401 0.99850 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.616 0.98875 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.197 0.83410 ## Engrais mineral - Fumier poulets == 0 1.534 0.64687 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.750 0.51465 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.330 0.22125 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.216 0.99993 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.796 0.96547 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.580 0.99142 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 * ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 * ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 ** ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 2.5.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 2.5.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;b&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 2.5.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral b ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 2.5.11 Associer les moyennes et les écart-types pour le rapport haut4_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(haut4, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(haut4_moy, &quot;tab/hauteur4_moyennes.csv&quot;) haut4_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 32.2 3.91 a ## 2 Fumier porcs 5 39.6 2.00 ab ## 3 Fumier poulets 5 36.8 5.32 ab ## 4 Engrais mineral 5 40.6 4.03 b ## 5 50% FPorcs + 50% Eng. Min. 5 41.1 3.98 b ## 6 50% FPoulets + 50% Eng. Min. 5 42.5 3.41 b 2.5.12 Graphe avec les comparaisons ggplot(haut4_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 50) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Hauteur des plants - cm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 2.5.13 Évolution de la hauteur des plants dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;hauteur&quot;, haut1, haut2, haut3, haut4) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;haut1&quot;] &lt;- &quot;21 JAR&quot; df$temps[df$temps == &quot;haut2&quot;] &lt;- &quot;35 JAR&quot; df$temps[df$temps == &quot;haut3&quot;] &lt;- &quot;42 JAR&quot; df$temps[df$temps == &quot;haut4&quot;] &lt;- &quot;49 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;hauteur&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/haut_moy_temps.csv&quot;) df_ic ## temps engrais N hauteur sd se ci ## 1 21 JAR Temoin 5 17.120 3.167657 1.4166192 3.933165 ## 2 21 JAR Fumier porcs 5 18.128 2.647597 1.1840414 3.287426 ## 3 21 JAR Fumier poulets 5 20.072 5.810737 2.5986408 7.214984 ## 4 21 JAR Engrais mineral 5 20.176 3.703894 1.6564317 4.598992 ## 5 21 JAR 50% FPorcs + 50% Eng. Min. 5 20.694 1.760804 0.7874554 2.186327 ## 6 21 JAR 50% FPoulets + 50% Eng. Min. 5 19.958 4.610984 2.0620946 5.725292 ## 7 35 JAR Temoin 5 24.108 4.314524 1.9295139 5.357190 ## 8 35 JAR Fumier porcs 5 31.574 2.043668 0.9139562 2.537549 ## 9 35 JAR Fumier poulets 5 28.840 6.252963 2.7964102 7.764079 ## 10 35 JAR Engrais mineral 5 32.664 2.450037 1.0956897 3.042122 ## 11 35 JAR 50% FPorcs + 50% Eng. Min. 5 34.226 3.953907 1.7682409 4.909424 ## 12 35 JAR 50% FPoulets + 50% Eng. Min. 5 33.456 3.868059 1.7298485 4.802830 ## 13 42 JAR Temoin 5 27.868 3.275228 1.4647266 4.066733 ## 14 42 JAR Fumier porcs 5 35.358 1.369752 0.6125716 1.700771 ## 15 42 JAR Fumier poulets 5 32.614 6.801414 3.0416847 8.445071 ## 16 42 JAR Engrais mineral 5 35.488 4.317403 1.9308014 5.360764 ## 17 42 JAR 50% FPorcs + 50% Eng. Min. 5 37.032 3.978275 1.7791386 4.939681 ## 18 42 JAR 50% FPoulets + 50% Eng. Min. 5 38.062 2.609458 1.1669850 3.240070 ## 19 49 JAR Temoin 5 32.150 3.908983 1.7481505 4.853644 ## 20 49 JAR Fumier porcs 5 39.574 2.002518 0.8955535 2.486455 ## 21 49 JAR Fumier poulets 5 36.778 5.319715 2.3790490 6.605299 ## 22 49 JAR Engrais mineral 5 40.562 4.026602 1.8007510 4.999686 ## 23 49 JAR 50% FPorcs + 50% Eng. Min. 5 41.094 3.983959 1.7816807 4.946739 ## 24 49 JAR 50% FPoulets + 50% Eng. Min. 5 42.526 3.406894 1.5236095 4.230218 ggplot(df_ic, aes(x = temps, y = hauteur, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Hauteur des plants - cm&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "],["diamètre-des-plants.html", "Chapitre 3 Diamètre des plants 3.1 Préparation des données 3.2 Diamètre 1 3.3 Diamètre 2 3.4 Diamètre 3 3.5 Diamètre 4", " Chapitre 3 Diamètre des plants 3.1 Préparation des données Jeu de données veg.csv qui contient différentes mesures dont les diamètres des plants de tomate, mesurés à 4 reprises : diam1 : 55 JAS, 21 JAR, semaine 3 AR diam2 : 69 JAS, 35 JAR, semaine 5 AR diam3 : 76 JAS, 42 JAR, semaine 6 AR diam4 : 83 JAS, 49 JAR, semaine 7 AR. La question est de savoir si les différents types dengrais induisent des diamètres ou augmentations de diamètre de plant significativement différentes. La démarche est la même que celle du chapitre précédent. df &lt;- read_csv(&quot;data/veg.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## .default = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## projet = col_character(), ## site = col_character(), ## date_semis = col_date(format = &quot;&quot;), ## date_repiquage = col_date(format = &quot;&quot;), ## period_repiq = col_character(), ## date_fert_1 = col_date(format = &quot;&quot;), ## period_fert1 = col_character(), ## date_1 = col_date(format = &quot;&quot;), ## period_d1 = col_character(), ## date_2 = col_date(format = &quot;&quot;), ## period_d2 = col_character(), ## date_fert_2 = col_date(format = &quot;&quot;), ## period_fert2 = col_character(), ## date_3 = col_date(format = &quot;&quot;), ## period_d3 = col_character(), ## date_4 = col_date(format = &quot;&quot;), ## period_d4 = col_character(), ## date_5 = col_date(format = &quot;&quot;) ## # ... with 10 more columns ## ) ## i Use `spec()` for the full column specifications. df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, diam1, diam2, diam3, diam4) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/diametres.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 8 ## id bloc traitement engrais diam1 diam2 diam3 diam4 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 3.29 5.06 5.78 6.31 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 6.28 6.73 7.43 7.9 ## 3 15 3 T2 Fumier poulets 4.68 4.68 5.07 5.63 ## 4 20 4 T1 Fumier porcs 3.76 5.21 5.35 5.8 ## 5 26 5 T1 Fumier porcs 5.21 6.04 6.28 6.89 3.2 Diamètre 1 3.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = diam1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 3.2.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(diam1) %&gt;% select(id, engrais, bloc, diam1, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id engrais bloc diam1 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 3 Fumier poulets 1 3.29 TRUE FALSE ## 2 23 50% FPorcs + 50% Eng. Min. 4 4.22 TRUE FALSE ## 3 12 50% FPoulets + 50% Eng. Min. 2 6.28 TRUE FALSE Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 3.2.3 Le modèle ANOVA lm1 &lt;- lm(diam1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: diam1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 1.527 5 0.6172 0.6879 ## Residuals 11.876 24 À la semaine 3 après le repiquage, il ne serait pas encore possible détablir des différences significatives entre les effets des traitements sur les Diamètres des plants. Mais vérifions les conditions de validité de lANOVA. 3.2.4 Indépendance des résidus plot(lm1, 1) 3.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.969 0.510 3.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.864 0.519 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; Pas de différence deffet sur le diamètre des plants à hauteur du colet à cette date. 3.2.7 Comparaisons par paires Tests post-hoc de comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 3.2.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 3.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 3.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 3.2.11 Associer les moyennes et les écart-types pour le rapport diam1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(diam1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(diam1_moy, &quot;tab/diametre1_moyennes.csv&quot;) diam1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 4.29 0.954 a ## 2 Fumier porcs 5 4.74 0.776 a ## 3 Fumier poulets 5 4.37 0.64 a ## 4 Engrais mineral 5 4.72 0.317 a ## 5 50% FPorcs + 50% Eng. Min. 5 4.82 0.374 a ## 6 50% FPoulets + 50% Eng. Min. 5 4.90 0.897 a 3.2.12 Graphe avec les comparaisons ggplot(diam1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 6) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 3.3 Diamètre 2 df &lt;- df_original 3.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = diam2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 3.3.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(diam2) %&gt;% select(id, engrais, bloc, diam2, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id engrais bloc diam2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 8 Fumier porcs 2 7.27 TRUE FALSE ## 2 22 Engrais mineral 4 5.51 TRUE TRUE ## 3 23 50% FPorcs + 50% Eng. Min. 4 5.21 TRUE FALSE Il y a une observation aberrante extrême. Mais toutes les trois ont été exclues pour améliorer la distribution. df &lt;- df %&gt;% filter(! id %in% df_out$id) #filter(id != 22) 3.3.3 Le modèle ANOVA lm2 &lt;- lm(diam2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: diam2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 7.1948 5 5.1392 0.003114 ** ## Residuals 5.8799 21 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage, au moins deux types dengrais ont des effets significativement différents sur les diamètres des plants à hauteur du collet. Mais vérifions les conditions de validité de lANOVA. 3.3.4 Indépendance des résidus plot(lm2, 1) 3.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.984 0.942 3.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 21 1.41 0.262 On va retenir que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 3.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = diam2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 0.6160 ## Fumier poulets - Temoin == 0 0.4640 ## Engrais mineral - Temoin == 0 1.1685 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 1.5085 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 1.1860 ## Fumier poulets - Fumier porcs == 0 -0.1520 ## Engrais mineral - Fumier porcs == 0 0.5525 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.8925 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.5700 ## Engrais mineral - Fumier poulets == 0 0.7045 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.0445 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.7220 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.3400 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.0175 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 -0.3225 ## Std. Error ## Fumier porcs - Temoin == 0 0.3550 ## Fumier poulets - Temoin == 0 0.3347 ## Engrais mineral - Temoin == 0 0.3550 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.3550 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.3347 ## Fumier poulets - Fumier porcs == 0 0.3550 ## Engrais mineral - Fumier porcs == 0 0.3742 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.3742 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.3550 ## Engrais mineral - Fumier poulets == 0 0.3550 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.3550 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.3347 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.3742 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.3550 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.3550 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 1.735 0.52456 ## Fumier poulets - Temoin == 0 1.386 0.73393 ## Engrais mineral - Temoin == 0 3.292 0.03543 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 4.250 0.00415 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.544 0.02043 ## Fumier poulets - Fumier porcs == 0 -0.428 0.99789 ## Engrais mineral - Fumier porcs == 0 1.477 0.68146 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 2.385 0.20575 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.606 0.60341 ## Engrais mineral - Fumier poulets == 0 1.985 0.38254 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.943 0.07287 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.157 0.29752 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.909 0.93980 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.049 1.00000 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 -0.909 0.93986 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 * ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ** ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 . ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 3.3.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 3.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;b&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 3.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral b ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 3.3.11 Associer les moyennes et les écart-types pour le rapport diam2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(diam2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(diam2_moy, &quot;tab/diametre2_moyennes.csv&quot;) diam2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 5.04 0.807 a ## 2 Fumier porcs 4 5.66 0.361 ab ## 3 Fumier poulets 5 5.51 0.671 ab ## 4 Engrais mineral 4 6.21 0.176 b ## 5 50% FPorcs + 50% Eng. Min. 4 6.55 0.314 b ## 6 50% FPoulets + 50% Eng. Min. 5 6.23 0.417 b 3.3.12 Graphe avec les comparaisons ggplot(diam2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 8) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 3.4 Diamètre 3 df &lt;- df_original 3.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = diam3)) + geom_boxplot() + theme_classic() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 3.4.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(diam3) %&gt;% select(engrais, bloc, diam3, is.outlier, is.extreme) df_out ## # A tibble: 6 x 5 ## engrais bloc diam3 is.outlier is.extreme ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 Fumier porcs 2 7.35 TRUE TRUE ## 2 Fumier porcs 4 5.35 TRUE TRUE ## 3 Fumier poulets 2 7.47 TRUE TRUE ## 4 Fumier poulets 3 5.07 TRUE FALSE ## 5 50% FPorcs + 50% Eng. Min. 1 7.53 TRUE FALSE ## 6 50% FPorcs + 50% Eng. Min. 4 6.04 TRUE TRUE Il y a 4 observations aberrantes extrêmes. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 3.4.3 Le modèle ANOVA lm3 &lt;- lm(diam3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: diam3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 9.1123 5 3.7301 0.01221 * ## Residuals 11.7260 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 6 après le repiquage, au moins deux types dengrais ont des effets significativement différents sur les Diamètres des plants. Mais vérifions les conditions de validité de lANOVA. 3.4.4 Indépendance des résidus plot(lm3, 1) 3.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.947 0.139 3.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.552 0.735 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 3.4.7 Comparaisons par paires cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = diam3 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 0.7820 ## Fumier poulets - Temoin == 0 0.5420 ## Engrais mineral - Temoin == 0 1.2780 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 1.4880 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 1.5240 ## Fumier poulets - Fumier porcs == 0 -0.2400 ## Engrais mineral - Fumier porcs == 0 0.4960 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.7060 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.7420 ## Engrais mineral - Fumier poulets == 0 0.7360 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.9460 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.9820 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.2100 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.2460 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.0360 ## Std. Error ## Fumier porcs - Temoin == 0 0.4421 ## Fumier poulets - Temoin == 0 0.4421 ## Engrais mineral - Temoin == 0 0.4421 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.4421 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.4421 ## Fumier poulets - Fumier porcs == 0 0.4421 ## Engrais mineral - Fumier porcs == 0 0.4421 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.4421 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.4421 ## Engrais mineral - Fumier poulets == 0 0.4421 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.4421 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.4421 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.4421 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.4421 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.4421 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 1.769 0.5029 ## Fumier poulets - Temoin == 0 1.226 0.8200 ## Engrais mineral - Temoin == 0 2.891 0.0762 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.366 0.0273 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.447 0.0228 ## Fumier poulets - Fumier porcs == 0 -0.543 0.9937 ## Engrais mineral - Fumier porcs == 0 1.122 0.8675 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.597 0.6081 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.678 0.5580 ## Engrais mineral - Fumier poulets == 0 1.665 0.5664 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.140 0.3014 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.221 0.2649 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.475 0.9966 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.556 0.9929 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.081 1.0000 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 . ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 * ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 3.4.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 3.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 3.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 3.4.11 Associer les moyennes et les écart-types pour le rapport diam3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(diam3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(diam3_moy, &quot;tab/diametre3_moyennes.csv&quot;) diam3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 5.50 0.947 a ## 2 Fumier porcs 5 6.29 0.712 ab ## 3 Fumier poulets 5 6.05 0.885 ab ## 4 Engrais mineral 5 6.78 0.58 ab ## 5 50% FPorcs + 50% Eng. Min. 5 6.99 0.562 b ## 6 50% FPoulets + 50% Eng. Min. 5 7.03 0.302 b 3.4.12 Graphe avec les comparaisons ggplot(diam3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 8) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 3.5 Diamètre 4 df &lt;- df_original 3.5.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = diam4)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 3.5.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(diam4) %&gt;% select(engrais, bloc, diam4, is.outlier, is.extreme) df_out ## # A tibble: 3 x 5 ## engrais bloc diam4 is.outlier is.extreme ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 Fumier porcs 2 7.89 TRUE FALSE ## 2 Engrais mineral 1 8.52 TRUE FALSE ## 3 Engrais mineral 4 6.11 TRUE FALSE Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 3.5.3 Le modèle ANOVA lm4 &lt;- lm(diam4 ~ engrais, data = df) Anova(lm4) ## Anova Table (Type II tests) ## ## Response: diam4 ## Sum Sq Df F value Pr(&gt;F) ## engrais 13.594 5 5.671 0.00137 ** ## Residuals 11.506 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 7 après le repiquage, au moins deux types dengrais ont des effets très significativement différents sur les Diamètres des plants. Mais vérifions les conditions de validité de lANOVA. 3.5.4 Indépendance des résidus plot(lm4, 1) 3.5.5 Normalité des résidus plot(lm4, 2) shapiro_test(residuals(lm4)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm4) 0.964 0.380 3.5.6 Homogénéité des variances plot(lm4, 3) levene_test(residuals(lm4) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.264 0.928 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 3.5.7 Comparaisons par paires cm &lt;- multcomp::glht(lm4, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = diam4 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 1.1260 ## Fumier poulets - Temoin == 0 0.9020 ## Engrais mineral - Temoin == 0 1.5380 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 1.7720 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.0660 ## Fumier poulets - Fumier porcs == 0 -0.2240 ## Engrais mineral - Fumier porcs == 0 0.4120 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.6460 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.9400 ## Engrais mineral - Fumier poulets == 0 0.6360 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.8700 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 1.1640 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.2340 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.5280 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.2940 ## Std. Error ## Fumier porcs - Temoin == 0 0.4379 ## Fumier poulets - Temoin == 0 0.4379 ## Engrais mineral - Temoin == 0 0.4379 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.4379 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.4379 ## Fumier poulets - Fumier porcs == 0 0.4379 ## Engrais mineral - Fumier porcs == 0 0.4379 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.4379 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.4379 ## Engrais mineral - Fumier poulets == 0 0.4379 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.4379 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.4379 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.4379 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.4379 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.4379 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 2.571 0.14337 ## Fumier poulets - Temoin == 0 2.060 0.34044 ## Engrais mineral - Temoin == 0 3.512 0.01958 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 4.046 0.00551 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 4.718 0.00102 ## Fumier poulets - Fumier porcs == 0 -0.512 0.99521 ## Engrais mineral - Fumier porcs == 0 0.941 0.93168 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.475 0.68238 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 2.147 0.29826 ## Engrais mineral - Fumier poulets == 0 1.452 0.69601 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.987 0.37836 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.658 0.12171 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.534 0.99414 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.206 0.82983 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.671 0.98348 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 * ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ** ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 ** ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 3.5.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 3.5.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;b&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 3.5.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral b ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 3.5.11 Associer les moyennes et les écart-types pour le rapport diam4_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(diam4, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(diam4_moy, &quot;tab/diametre4_moyennes.csv&quot;) diam4_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 5.60 0.719 a ## 2 Fumier porcs 5 6.73 0.763 ab ## 3 Fumier poulets 5 6.50 0.721 ab ## 4 Engrais mineral 5 7.14 0.885 b ## 5 50% FPorcs + 50% Eng. Min. 5 7.37 0.561 b ## 6 50% FPoulets + 50% Eng. Min. 5 7.67 0.398 b 3.5.12 Graphe avec les comparaisons ggplot(diam4_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 8) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Diamètre des plants - mm&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 3.5.13 Évolution du diamètre au collet des plants dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;diametre&quot;, diam1, diam2, diam3, diam4) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;diam1&quot;] &lt;- &quot;21 JAR&quot; df$temps[df$temps == &quot;diam2&quot;] &lt;- &quot;35 JAR&quot; df$temps[df$temps == &quot;diam3&quot;] &lt;- &quot;42 JAR&quot; df$temps[df$temps == &quot;diam4&quot;] &lt;- &quot;49 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;diametre&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/diam_moy_temps.csv&quot;) df_ic ## temps engrais N diametre sd se ci ## 1 21 JAR Temoin 5 4.294 0.9544789 0.4268559 1.1851421 ## 2 21 JAR Fumier porcs 5 4.736 0.7764213 0.3472262 0.9640543 ## 3 21 JAR Fumier poulets 5 4.374 0.6398672 0.2861573 0.7945000 ## 4 21 JAR Engrais mineral 5 4.724 0.3169858 0.1417604 0.3935899 ## 5 21 JAR 50% FPorcs + 50% Eng. Min. 5 4.822 0.3739920 0.1672543 0.4643724 ## 6 21 JAR 50% FPoulets + 50% Eng. Min. 5 4.896 0.8973461 0.4013054 1.1142023 ## 7 35 JAR Temoin 5 5.044 0.8072051 0.3609931 1.0022775 ## 8 35 JAR Fumier porcs 5 5.982 0.7850287 0.3510755 0.9747418 ## 9 35 JAR Fumier poulets 5 5.508 0.6707980 0.2999900 0.8329058 ## 10 35 JAR Engrais mineral 5 6.072 0.3490272 0.1560897 0.4333745 ## 11 35 JAR 50% FPorcs + 50% Eng. Min. 5 6.284 0.6590372 0.2947304 0.8183027 ## 12 35 JAR 50% FPoulets + 50% Eng. Min. 5 6.230 0.4166533 0.1863330 0.5173434 ## 13 42 JAR Temoin 5 5.504 0.9466150 0.4233391 1.1753778 ## 14 42 JAR Fumier porcs 5 6.286 0.7124114 0.3186001 0.8845756 ## 15 42 JAR Fumier poulets 5 6.046 0.8854547 0.3959874 1.0994372 ## 16 42 JAR Engrais mineral 5 6.782 0.5804912 0.2596035 0.7207750 ## 17 42 JAR 50% FPorcs + 50% Eng. Min. 5 6.992 0.5618452 0.2512648 0.6976229 ## 18 42 JAR 50% FPoulets + 50% Eng. Min. 5 7.028 0.3020265 0.1350704 0.3750154 ## 19 49 JAR Temoin 5 5.602 0.7192844 0.3216737 0.8931095 ## 20 49 JAR Fumier porcs 5 6.728 0.7630334 0.3412389 0.9474311 ## 21 49 JAR Fumier poulets 5 6.504 0.7214430 0.3226391 0.8957898 ## 22 49 JAR Engrais mineral 5 7.140 0.8852118 0.3958788 1.0991357 ## 23 49 JAR 50% FPorcs + 50% Eng. Min. 5 7.374 0.5605622 0.2506910 0.6960299 ## 24 49 JAR 50% FPoulets + 50% Eng. Min. 5 7.668 0.3982085 0.1780842 0.4944411 ggplot(df_ic, aes(x = temps, y = diametre, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Diamètre au collet des plants - cm&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "],["nombre-de-feuilles.html", "Chapitre 4 Nombre de feuilles 4.1 Préparation des données 4.2 Feuilles 1 4.3 Feuilles 2 4.4 Feuilles 3 4.5 Feuilles 4", " Chapitre 4 Nombre de feuilles 4.1 Préparation des données Jeu de données veg.csv qui contient différentes mesures dont le nombre de feuilles des plants de tomate, compté à 4 reprises : feuil1 : 55 JAS, 21 JAR, semaine 3 AR feuil2 : 69 JAS, 35 JAR, semaine 5 AR feuil3 : 76 JAS, 42 JAR, semaine 6 AR feuil4 : 83 JAS, 49 JAR, semaine 7 AR. La question est de savoir si les différents types dengrais induisent des qantités de feuilles significativement différentes. df &lt;- read_csv(&quot;data/veg.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## .default = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## projet = col_character(), ## site = col_character(), ## date_semis = col_date(format = &quot;&quot;), ## date_repiquage = col_date(format = &quot;&quot;), ## period_repiq = col_character(), ## date_fert_1 = col_date(format = &quot;&quot;), ## period_fert1 = col_character(), ## date_1 = col_date(format = &quot;&quot;), ## period_d1 = col_character(), ## date_2 = col_date(format = &quot;&quot;), ## period_d2 = col_character(), ## date_fert_2 = col_date(format = &quot;&quot;), ## period_fert2 = col_character(), ## date_3 = col_date(format = &quot;&quot;), ## period_d3 = col_character(), ## date_4 = col_date(format = &quot;&quot;), ## period_d4 = col_character(), ## date_5 = col_date(format = &quot;&quot;) ## # ... with 10 more columns ## ) ## i Use `spec()` for the full column specifications. df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, feuil1, feuil2, feuil3, feuil4) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/feuilles.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 8 ## id bloc traitement engrais feuil1 feuil2 feuil3 feuil4 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 6.25 8.43 10.4 13.1 ## 2 12 2 T5 50% FPoulets + 50% Eng. Mi~ 8.71 11 10.3 13.1 ## 3 15 3 T2 Fumier poulets 8.13 8.33 10 9.33 ## 4 20 4 T1 Fumier porcs 7.88 10.4 12 11.2 ## 5 26 5 T1 Fumier porcs 8.88 11.1 11.5 11.5 4.2 Feuilles 1 4.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = feuil1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 4.2.2 Identification des échantillons aberrants et extêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(feuil1) %&gt;% select(id, engrais, bloc, feuil1, is.outlier, is.extreme) df_out ## # A tibble: 4 x 6 ## id engrais bloc feuil1 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 1 Temoin 1 5.86 TRUE FALSE ## 2 3 Fumier poulets 1 6.25 TRUE TRUE ## 3 9 Fumier poulets 2 9.14 TRUE TRUE ## 4 12 50% FPoulets + 50% Eng. Min. 2 8.71 TRUE FALSE Il y a 2 observations aberrantes extrêmes. Pas exclues ! #df &lt;- df %&gt;% filter(! id %in% c(3, 9)) #df_out$id) 4.2.3 Le modèle ANOVA lm1 &lt;- lm(feuil1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: feuil1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 4.4714 5 1.8156 0.1478 ## Residuals 11.8211 24 À la semaine 3 après le repiquage, il ne serait pas encore possible détablir des différences significatives entre les effets des traitements sur le nombre de feuilles des plants. Mais vérifions les conditions de validité de lANOVA. 4.2.4 Indépendance des résidus plot(lm1, 1) 4.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.945 0.125 4.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.815 0.551 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; Pas de différence deffet sur le nombre de feuilles des plants à cette date. 4.2.7 Comparaisons par paires Tests post-hoc de comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 4.2.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 4.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 4.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 4.2.11 Associer les moyennes et les écart-types pour le rapport feuil1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(feuil1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(feuil1_moy, &quot;tab/feuille1_moyennes.csv&quot;) feuil1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 7.27 0.94 a ## 2 Fumier porcs 5 8.18 0.521 a ## 3 Fumier poulets 5 7.99 1.06 a ## 4 Engrais mineral 5 8.10 0.455 a ## 5 50% FPorcs + 50% Eng. Min. 5 8.44 0.661 a ## 6 50% FPoulets + 50% Eng. Min. 5 8.39 0.189 a 4.2.12 Graphe avec les comparaisons ggplot(feuil1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 9) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 4.3 Feuilles 2 df &lt;- df_original 4.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = feuil2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 4.3.2 Identification des échantillons aberrants et extêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(feuil2) %&gt;% select(id, engrais, bloc, feuil2, is.outlier, is.extreme) df_out ## # A tibble: 1 x 6 ## id engrais bloc feuil2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 10 Engrais mineral 2 7.83 TRUE FALSE Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 4.3.3 Le modèle ANOVA lm2 &lt;- lm(feuil2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: feuil2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 46.179 5 4.3199 0.006053 ** ## Residuals 51.311 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage, au moins deux types dengrais ont des effets très significativement différents sur le nombre de feuilles des plants. Mais vérifions les conditions de validité de lANOVA. 4.3.4 Indépendance des résidus plot(lm2, 1) 4.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.959 0.288 4.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.403 0.842 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 4.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = feuil2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 2.6060 ## Fumier poulets - Temoin == 0 0.7540 ## Engrais mineral - Temoin == 0 2.0820 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.7200 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.6720 ## Fumier poulets - Fumier porcs == 0 -1.8520 ## Engrais mineral - Fumier porcs == 0 -0.5240 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.1140 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.0660 ## Engrais mineral - Fumier poulets == 0 1.3280 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.9660 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.9180 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.6380 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.5900 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.9520 ## Std. Error ## Fumier porcs - Temoin == 0 0.9248 ## Fumier poulets - Temoin == 0 0.9248 ## Engrais mineral - Temoin == 0 0.9248 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.9248 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.9248 ## Fumier poulets - Fumier porcs == 0 0.9248 ## Engrais mineral - Fumier porcs == 0 0.9248 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.9248 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.9248 ## Engrais mineral - Fumier poulets == 0 0.9248 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.9248 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.9248 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.9248 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.9248 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.9248 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 2.818 0.08852 ## Fumier poulets - Temoin == 0 0.815 0.96183 ## Engrais mineral - Temoin == 0 2.251 0.25240 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.941 0.06882 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.971 0.00657 ## Fumier poulets - Fumier porcs == 0 -2.003 0.36991 ## Engrais mineral - Fumier porcs == 0 -0.567 0.99231 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.123 1.00000 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.153 0.85416 ## Engrais mineral - Fumier poulets == 0 1.436 0.70567 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.126 0.30805 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 3.155 0.04362 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.690 0.98137 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.719 0.53294 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.029 0.90334 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 . ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 ** ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 * ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 4.3.8 Graphe des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 4.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 4.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 4.3.11 Associer les moyennes et les écart-types pour le rapport feuil2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(feuil2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(feuil2_moy, &quot;tab/feuille2_moyennes.csv&quot;) feuil2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 8.37 1.94 a ## 2 Fumier porcs 5 11.0 0.847 ab ## 3 Fumier poulets 5 9.12 1.08 a ## 4 Engrais mineral 5 10.5 1.55 ab ## 5 50% FPorcs + 50% Eng. Min. 5 11.1 1.36 ab ## 6 50% FPoulets + 50% Eng. Min. 5 12.0 1.71 b 4.3.12 Graphe avec les comparaisons ggplot(feuil2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 15) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 4.4 Feuilles 3 df &lt;- df_original 4.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = feuil3)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 4.4.2 Identification des échantillons aberrants et extêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(feuil3) %&gt;% select(id, engrais, bloc, feuil3, is.outlier, is.extreme) df_out ## # A tibble: 1 x 6 ## id engrais bloc feuil3 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 18 50% FPoulets + 50% Eng. Min. 3 15 TRUE FALSE Il ny a pas dobservation aberrante extrême. df &lt;- df %&gt;% filter(! id %in% df_out$id) 4.4.3 Le modèle ANOVA lm3 &lt;- lm(feuil3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: feuil3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 31.269 5 2.4482 0.06425 . ## Residuals 58.752 23 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 6 après le repiquage, il ny aurait pas deffets significativement différents sur le nombre de feuilles des plants. Mais vérifions les conditions de validité de lANOVA. 4.4.4 Indépendance des résidus plot(lm3, 1) 4.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.974 0.673 4.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 23 0.916 0.488 On retient que la conclusion de lANOVA peut être considérée valide. Affichons quand même les comparaisons par paires. 4.4.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 4.4.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 4.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 4.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 4.4.11 Associer les moyennes et les écart-types pour le rapport feuil3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(feuil3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(feuil3_moy, &quot;tab/feuille3_moyennes.csv&quot;) feuil3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 9.15 1.62 a ## 2 Fumier porcs 5 12.2 1.87 a ## 3 Fumier poulets 5 10.8 0.669 a ## 4 Engrais mineral 5 11.1 2.18 a ## 5 50% FPorcs + 50% Eng. Min. 5 12.1 1.71 a ## 6 50% FPoulets + 50% Eng. Min. 4 11.2 0.761 a 4.4.12 Graphe avec les comparaisons ggplot(feuil3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 15) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 4.5 Feuilles 4 df &lt;- df_original 4.5.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = feuil4)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 4.5.2 Identification des échantillons aberrants et extêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(feuil4) %&gt;% select(engrais, bloc, feuil4, is.outlier, is.extreme) df_out ## # A tibble: 1 x 5 ## engrais bloc feuil4 is.outlier is.extreme ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 Engrais mineral 4 8.83 TRUE FALSE Il ny a pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 4.5.3 Le modèle ANOVA lm4 &lt;- lm(feuil4 ~ engrais, data = df) Anova(lm4) ## Anova Table (Type II tests) ## ## Response: feuil4 ## Sum Sq Df F value Pr(&gt;F) ## engrais 30.830 5 2.1199 0.09774 . ## Residuals 69.808 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 7 après le repiquage, il ny aurait également pas deffets significativement différents sur le nombre de feuilles des plants. Mais vérifions les conditions de validité de lANOVA. 4.5.4 Indépendance des résidus plot(lm4, 1) 4.5.5 Normalité des résidus plot(lm4, 2) shapiro_test(residuals(lm4)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm4) 0.981 0.863 4.5.6 Homogénéité des variances plot(lm4, 3) levene_test(residuals(lm4) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.851 0.527 On retient que la conclusion de lANOVA peut être considérée valide. Affichons quand même les comparaisons par paires. 4.5.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais) pour identifier ceux dont les effets sont différents. cm &lt;- multcomp::glht(lm4, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 4.5.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 4.5.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 4.5.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 4.5.11 Associer les moyennes et les écart-types pour le rapport feuil4_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(feuil4, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(feuil4_moy, &quot;tab/feuille4_moyennes.csv&quot;) feuil4_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 9.79 1.37 a ## 2 Fumier porcs 5 12.2 1.95 a ## 3 Fumier poulets 5 11.4 1.45 a ## 4 Engrais mineral 5 11.9 1.80 a ## 5 50% FPorcs + 50% Eng. Min. 5 12.6 2.47 a ## 6 50% FPoulets + 50% Eng. Min. 5 12.9 0.588 a 4.5.12 Graphe avec les comparaisons ggplot(feuil4_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 15) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de feuilles&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 4.5.13 Évolution du nombre de feuilles dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;feuille&quot;, feuil1, feuil2, feuil3, feuil4) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;feuil1&quot;] &lt;- &quot;21 JAR&quot; df$temps[df$temps == &quot;feuil2&quot;] &lt;- &quot;35 JAR&quot; df$temps[df$temps == &quot;feuil3&quot;] &lt;- &quot;42 JAR&quot; df$temps[df$temps == &quot;feuil4&quot;] &lt;- &quot;49 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;feuille&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/feuil_moy_temps.csv&quot;) df_ic ## temps engrais N feuille sd se ci ## 1 21 JAR Temoin 5 7.274 0.9401489 0.42044738 1.1673491 ## 2 21 JAR Fumier porcs 5 8.178 0.5213636 0.23316089 0.6473584 ## 3 21 JAR Fumier poulets 5 7.988 1.0582155 0.47324835 1.3139481 ## 4 21 JAR Engrais mineral 5 8.098 0.4546097 0.20330765 0.5644725 ## 5 21 JAR 50% FPorcs + 50% Eng. Min. 5 8.440 0.6612110 0.29570255 0.8210019 ## 6 21 JAR 50% FPoulets + 50% Eng. Min. 5 8.394 0.1894202 0.08471127 0.2351962 ## 7 35 JAR Temoin 5 8.370 1.9423826 0.86865989 2.4117865 ## 8 35 JAR Fumier porcs 5 10.976 0.8469534 0.37876906 1.0516315 ## 9 35 JAR Fumier poulets 5 9.124 1.0800370 0.48300725 1.3410431 ## 10 35 JAR Engrais mineral 5 10.452 1.5476498 0.69213005 1.9216611 ## 11 35 JAR 50% FPorcs + 50% Eng. Min. 5 11.090 1.3563185 0.60656409 1.6840919 ## 12 35 JAR 50% FPoulets + 50% Eng. Min. 5 12.042 1.7135694 0.76633152 2.1276774 ## 13 42 JAR Temoin 5 9.148 1.6150758 0.72228388 2.0053815 ## 14 42 JAR Fumier porcs 5 12.218 1.8729175 0.83759417 2.3255342 ## 15 42 JAR Fumier poulets 5 10.758 0.6693056 0.29932257 0.8310527 ## 16 42 JAR Engrais mineral 5 11.056 2.1835476 0.97651216 2.7112324 ## 17 42 JAR 50% FPorcs + 50% Eng. Min. 5 12.136 1.7091606 0.76435986 2.1222032 ## 18 42 JAR 50% FPoulets + 50% Eng. Min. 5 11.938 1.8343037 0.82032555 2.2775888 ## 19 49 JAR Temoin 5 9.792 1.3691676 0.61231038 1.7000462 ## 20 49 JAR Fumier porcs 5 12.186 1.9457595 0.87017010 2.4159795 ## 21 49 JAR Fumier poulets 5 11.424 1.4494240 0.64820213 1.7996976 ## 22 49 JAR Engrais mineral 5 11.878 1.7989914 0.80453341 2.2337428 ## 23 49 JAR 50% FPorcs + 50% Eng. Min. 5 12.614 2.4714429 1.10526286 3.0687017 ## 24 49 JAR 50% FPoulets + 50% Eng. Min. 5 12.884 0.5884131 0.26314635 0.7306114 ggplot(df_ic, aes(x = temps, y = feuille, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Nombre de feuilles&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "],["nombre-de-fleurs.html", "Chapitre 5 Nombre de fleurs 5.1 Préparation des données 5.2 Fleurs 1 5.3 Fleurs 2 5.4 Fleurs 3", " Chapitre 5 Nombre de fleurs 5.1 Préparation des données Jeu de données rdt.csv qui contient différentes mesures dont le nombre de fleurs, compté à 3 reprises en cours de culture : fleur1 : 86 JAS, 52 JAR, semaine 8 AR fleur2 : 93 JAS, 59 JAR, semaine 9 AR fleur3 : 100 JAS, 66 JAR, semaine 10 AR. La question est de savoir si les différents types dengrais induisent des quantités de fleurs significativement différentes. df &lt;- read_csv(&quot;data/rdt.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## bloc = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## fleur1 = col_double(), ## fruit1 = col_double(), ## fleur2 = col_double(), ## fruit2 = col_double(), ## fleur3 = col_double(), ## fruit3 = col_double(), ## taux_fruit = col_double(), ## nfruits_re_m2 = col_double(), ## taux_nou_5 = col_double(), ## taux_nou_6 = col_double(), ## taux_nou_7 = col_double(), ## rdt_kgha = col_double(), ## rdt_tha = col_double() ## ) df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, fleur1, fleur2, fleur3) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/fleurs.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 7 ## id bloc traitement engrais fleur1 fleur2 fleur3 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 76 70.3 75.3 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 81.7 72.6 60 ## 3 15 3 T2 Fumier poulets 44.8 45.6 36.8 ## 4 20 4 T1 Fumier porcs 79 74 46 ## 5 26 5 T1 Fumier porcs 61.1 58.3 38.7 5.2 Fleurs 1 5.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fleur1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 5.2.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fleur1) %&gt;% select(id, engrais, bloc, fleur1, is.outlier, is.extreme) df_out ## # A tibble: 1 x 6 ## id engrais bloc fleur1 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 18 50% FPoulets + 50% Eng. Min. 3 137. TRUE TRUE Il y a une observation aberrante extrême. Écartée pour améliorer la distribution ! df &lt;- df %&gt;% filter(! id %in% df_out$id) 5.2.3 Le modèle ANOVA lm1 &lt;- lm(fleur1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: fleur1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 2104.9 5 2.1376 0.09702 . ## Residuals 4529.6 23 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 En début de floraison, il ne serait pas encore possible détablir des différences significatives entre les effets des traitements sur le Nombre de fleurs des plants. Mais vérifions les conditions de validité de lANOVA. 5.2.4 Indépendance des résidus plot(lm1, 1) 5.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.975 0.694 5.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 23 0.550 0.737 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; Pas de différence deffet sur le Nombre de fleurs des plants à cette date. 5.2.7 Comparaisons par paires Tests post-hoc de comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 5.2.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 5.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 5.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 5.2.11 Associer les moyennes et les écart-types pour le rapport fleur1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fleur1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fleur1_moy, &quot;tab/fleur1_moyennes.csv&quot;) fleur1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 47.3 16.9 a ## 2 Fumier porcs 5 66.5 10.0 a ## 3 Fumier poulets 5 61.4 12.7 a ## 4 Engrais mineral 5 62.9 16.4 a ## 5 50% FPorcs + 50% Eng. Min. 5 73.7 16.5 a ## 6 50% FPoulets + 50% Eng. Min. 4 70.6 7.69 a 5.2.12 Graphe avec les comparaisons ggplot(fleur1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 90) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 5.3 Fleurs 2 df &lt;- df_original 5.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fleur2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 5.3.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fleur2) %&gt;% select(id, engrais, bloc, fleur2, is.outlier, is.extreme) df_out ## # A tibble: 4 x 6 ## id engrais bloc fleur2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 10 Engrais mineral 2 45.6 TRUE FALSE ## 2 16 Engrais mineral 3 89.6 TRUE TRUE ## 3 17 50% FPorcs + 50% Eng. Min. 3 45.3 TRUE FALSE ## 4 18 50% FPoulets + 50% Eng. Min. 3 158. TRUE TRUE Il y a 2 observations aberrantes extrêmes. Exclues pour améliorer la distribution. df &lt;- df %&gt;% filter(! id %in% c(16, 18)) #df_out$id) 5.3.3 Le modèle ANOVA lm2 &lt;- lm(fleur2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: fleur2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 3181.5 5 4.112 0.008681 ** ## Residuals 3404.3 22 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage, au moins deux types dengrais ont des effets significativement différents sur le Nombre de fleurs des plants. Mais vérifions les conditions de validité de lANOVA. 5.3.4 Indépendance des résidus plot(lm2, 1) 5.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.955 0.262 5.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 22 0.489 0.781 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 5.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = fleur2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 19.756 ## Fumier poulets - Temoin == 0 12.296 ## Engrais mineral - Temoin == 0 10.778 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 24.788 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 33.853 ## Fumier poulets - Fumier porcs == 0 -7.460 ## Engrais mineral - Fumier porcs == 0 -8.979 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 5.032 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 14.096 ## Engrais mineral - Fumier poulets == 0 -1.518 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 12.492 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 21.556 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 14.010 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 23.075 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 9.064 ## Std. Error ## Fumier porcs - Temoin == 0 7.867 ## Fumier poulets - Temoin == 0 7.867 ## Engrais mineral - Temoin == 0 8.345 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 7.867 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 8.345 ## Fumier poulets - Fumier porcs == 0 7.867 ## Engrais mineral - Fumier porcs == 0 8.345 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 7.867 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 8.345 ## Engrais mineral - Fumier poulets == 0 8.345 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 7.867 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 8.345 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 8.345 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 8.796 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 8.345 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 2.511 0.16346 ## Fumier poulets - Temoin == 0 1.563 0.62931 ## Engrais mineral - Temoin == 0 1.292 0.78601 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.151 0.04626 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 4.057 0.00603 ## Fumier poulets - Fumier porcs == 0 -0.948 0.92900 ## Engrais mineral - Fumier porcs == 0 -1.076 0.88548 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.640 0.98654 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.689 0.55198 ## Engrais mineral - Fumier poulets == 0 -0.182 0.99997 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.588 0.61410 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.583 0.14341 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 1.679 0.55826 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 2.623 0.13296 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.086 0.88142 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 * ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 ** ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 5.3.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 5.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;b&quot; &quot;b&quot; 5.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. b ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 5.3.11 Associer les moyennes et les écart-types pour le rapport fleur2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fleur2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fleur2_moy, &quot;tab/fleur2_moyennes.csv&quot;) fleur2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 46.5 16.9 a ## 2 Fumier porcs 5 66.3 9.70 ab ## 3 Fumier poulets 5 58.8 10.8 ab ## 4 Engrais mineral 4 57.3 8.27 ab ## 5 50% FPorcs + 50% Eng. Min. 5 71.3 15.3 b ## 6 50% FPoulets + 50% Eng. Min. 4 80.4 9.76 b 5.3.12 Graphe avec les comparaisons ggplot(fleur2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 90) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 5.4 Fleurs 3 df &lt;- df_original 5.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fleur3)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 5.4.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fleur3) %&gt;% select(id, engrais, bloc, fleur3, is.outlier, is.extreme) df_out ## # A tibble: 5 x 6 ## id engrais bloc fleur3 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 1 Temoin 1 24 TRUE FALSE ## 2 25 Temoin 5 83.3 TRUE TRUE ## 3 17 50% FPorcs + 50% Eng. Min. 3 32 TRUE FALSE ## 4 23 50% FPorcs + 50% Eng. Min. 4 97.3 TRUE FALSE ## 5 18 50% FPoulets + 50% Eng. Min. 3 101. TRUE TRUE Il y a 2 observations aberrantes extrêmes. #df &lt;- df %&gt;% filter(! id %in% c(18, 25)) #df_out$id) 5.4.3 Le modèle ANOVA lm3 &lt;- lm(fleur3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: fleur3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 1726.6 5 0.8995 0.4974 ## Residuals 9213.8 24 Il ny aurait pas deffets significativement différents sur le Nombre de fleurs des plants à cette date. Mais vérifions les conditions de validité de lANOVA. 5.4.4 Indépendance des résidus plot(lm3, 1) 5.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.943 0.110 5.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.415 0.834 On retient que la conclusion de lANOVA peut être considérée valide. Affichons quand même les comparaisons par paires. 5.4.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 5.4.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 5.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 5.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 5.4.11 Associer les moyennes et les écart-types pour le rapport fleur3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fleur3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fleur3_moy, &quot;tab/fleur3_moyennes.csv&quot;) fleur3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 47.6 21.9 a ## 2 Fumier porcs 5 50.1 8.89 a ## 3 Fumier poulets 5 59.7 16.7 a ## 4 Engrais mineral 5 63.4 24.0 a ## 5 50% FPorcs + 50% Eng. Min. 5 63.6 23.7 a ## 6 50% FPoulets + 50% Eng. Min. 5 68.8 18.2 a 5.4.12 Graphe avec les comparaisons ggplot(fleur3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 75) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fleurs&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 5.4.13 Évolution du nombre de fleurs dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;fleur&quot;, fleur1, fleur2, fleur3) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;fleur1&quot;] &lt;- &quot;52 JAR&quot; df$temps[df$temps == &quot;fleur2&quot;] &lt;- &quot;59 JAR&quot; df$temps[df$temps == &quot;fleur3&quot;] &lt;- &quot;66 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;fleur&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/fleur_moy_temps.csv&quot;) df_ic ## temps engrais N fleur sd se ci ## 1 52 JAR Temoin 5 47.272 16.869184 7.544128 20.94586 ## 2 52 JAR Fumier porcs 5 66.462 10.014630 4.478679 12.43481 ## 3 52 JAR Fumier poulets 5 61.432 12.658757 5.661168 15.71792 ## 4 52 JAR Engrais mineral 5 62.902 16.443507 7.353760 20.41731 ## 5 52 JAR 50% FPorcs + 50% Eng. Min. 5 73.680 16.509632 7.383332 20.49942 ## 6 52 JAR 50% FPoulets + 50% Eng. Min. 5 83.812 30.235126 13.521559 37.54187 ## 7 59 JAR Temoin 5 46.540 16.882800 7.550218 20.96277 ## 8 59 JAR Fumier porcs 5 66.296 9.701476 4.338632 12.04597 ## 9 59 JAR Fumier poulets 5 58.836 10.779074 4.820548 13.38399 ## 10 59 JAR Engrais mineral 5 63.774 16.117332 7.207890 20.01231 ## 11 59 JAR 50% FPorcs + 50% Eng. Min. 5 71.328 15.263924 6.826234 18.95266 ## 12 59 JAR 50% FPoulets + 50% Eng. Min. 5 95.834 35.547388 15.897275 44.13791 ## 13 66 JAR Temoin 5 47.572 21.851670 9.772364 27.13243 ## 14 66 JAR Fumier porcs 5 50.122 8.886986 3.974381 11.03465 ## 15 66 JAR Fumier poulets 5 59.740 16.699969 7.468453 20.73575 ## 16 66 JAR Engrais mineral 5 63.400 24.006249 10.735921 29.80770 ## 17 66 JAR 50% FPorcs + 50% Eng. Min. 5 63.566 23.691756 10.595275 29.41720 ## 18 66 JAR 50% FPoulets + 50% Eng. Min. 5 68.760 18.179329 8.130043 22.57262 ggplot(df_ic, aes(x = temps, y = fleur, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Nombre de fleurs&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "],["nombre-de-fruits.html", "Chapitre 6 Nombre de fruits 6.1 Préparation des données 6.2 Fruits 1 6.3 Fruits 2 6.4 Fruits 3", " Chapitre 6 Nombre de fruits 6.1 Préparation des données Jeu de données rdt.csv qui contient différentes mesures dont les nombres de fruits, comptés à 3 reprises en cours de culture : fruit1 : 86 JAS, 52 JAR, semaine 8 AR fruit2 : 93 JAS, 59 JAR, semaine 9 AR fruit3 : 100 JAS, 66 JAR, semaine 10 AR. La question est de savoir si les différents types dengrais induisent des quantités de fruits significativement différentes. df &lt;- read_csv(&quot;data/rdt.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## bloc = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## fleur1 = col_double(), ## fruit1 = col_double(), ## fleur2 = col_double(), ## fruit2 = col_double(), ## fleur3 = col_double(), ## fruit3 = col_double(), ## taux_fruit = col_double(), ## nfruits_re_m2 = col_double(), ## taux_nou_5 = col_double(), ## taux_nou_6 = col_double(), ## taux_nou_7 = col_double(), ## rdt_kgha = col_double(), ## rdt_tha = col_double() ## ) df &lt;- df %&gt;% mutate(id = 1:nrow(.), .before = 1) %&gt;% select(id, bloc, traitement, engrais, fruit1, fruit2, fruit3) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/fruits.csv&quot;) df_original &lt;- df # une copie set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 7 ## id bloc traitement engrais fruit1 fruit2 fruit3 ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 6.86 12.6 24.7 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 13.7 22.9 26.9 ## 3 15 3 T2 Fumier poulets 7.2 8 11.2 ## 4 20 4 T1 Fumier porcs 8 13 24.5 ## 5 26 5 T1 Fumier porcs 10.9 14.9 12 6.2 Fruits 1 6.2.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit1)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.2.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit1) %&gt;% select(id, engrais, bloc, fruit1, is.outlier, is.extreme) df_out ## # A tibble: 5 x 6 ## id engrais bloc fruit1 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 25 Temoin 5 16 TRUE FALSE ## 2 9 Fumier poulets 2 5 TRUE FALSE ## 3 27 Fumier poulets 5 12 TRUE TRUE ## 4 11 50% FPorcs + 50% Eng. Min. 2 18.5 TRUE FALSE ## 5 18 50% FPoulets + 50% Eng. Min. 3 25.7 TRUE FALSE Il y a une observation aberrante extrême. Tous les outliers exclus pour améliorer la distribution. df &lt;- df %&gt;% filter(! id %in% df_out$id) #filter(id != 27) 6.2.3 Le modèle ANOVA lm1 &lt;- lm(fruit1 ~ engrais, data = df) Anova(lm1) ## Anova Table (Type II tests) ## ## Response: fruit1 ## Sum Sq Df F value Pr(&gt;F) ## engrais 131.58 5 3.2452 0.02763 * ## Residuals 154.08 19 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 En début de nouaison, il y aurait une différence significative entre les effets dau moins 2 engrais sur le Nombre de fruits des plants. Mais vérifions les conditions de validité de lANOVA. 6.2.4 Indépendance des résidus plot(lm1, 1) 6.2.5 Normalité des résidus plot(lm1, 2) shapiro_test(residuals(lm1)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm1) 0.957 0.349 6.2.6 Homogénéité des variances plot(lm1, 3) levene_test(residuals(lm1) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 19 1.29 0.308 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; différence deffet sur le Nombre de fruits des plants entre au moins deux engrais à cette date. 6.2.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm1, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = fruit1 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 6.02800 ## Fumier poulets - Temoin == 0 3.47667 ## Engrais mineral - Temoin == 0 3.51400 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.76500 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 7.12750 ## Fumier poulets - Fumier porcs == 0 -2.55133 ## Engrais mineral - Fumier porcs == 0 -2.51400 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 -3.26300 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.09950 ## Engrais mineral - Fumier poulets == 0 0.03733 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.71167 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 3.65083 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 -0.74900 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 3.61350 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 4.36250 ## Std. Error ## Fumier porcs - Temoin == 0 1.91030 ## Fumier poulets - Temoin == 0 2.17497 ## Engrais mineral - Temoin == 0 1.91030 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.01363 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 2.01363 ## Fumier poulets - Fumier porcs == 0 2.07967 ## Engrais mineral - Fumier porcs == 0 1.80105 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.91030 ## Engrais mineral - Fumier poulets == 0 2.07967 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 2.17497 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.17497 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.91030 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.01363 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 3.156 0.0502 ## Fumier poulets - Temoin == 0 1.598 0.6080 ## Engrais mineral - Temoin == 0 1.840 0.4647 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 1.373 0.7408 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.540 0.0227 ## Fumier poulets - Fumier porcs == 0 -1.227 0.8178 ## Engrais mineral - Fumier porcs == 0 -1.396 0.7280 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 -1.708 0.5418 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.576 0.9915 ## Engrais mineral - Fumier poulets == 0 0.018 1.0000 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.327 0.9994 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 1.679 0.5596 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 -0.392 0.9986 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.892 0.4352 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.166 0.2966 ## ## Fumier porcs - Temoin == 0 . ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 6.2.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 6.2.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 6.2.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 6.2.11 Associer les moyennes et les écart-types pour le rapport fruit1_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit1, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit1_moy, &quot;tab/fruit1_moyennes.csv&quot;) fruit1_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 4 3.71 3.10 a ## 2 Fumier porcs 5 9.74 2.49 ab ## 3 Fumier poulets 3 7.19 0.32 ab ## 4 Engrais mineral 5 7.22 3.18 ab ## 5 50% FPorcs + 50% Eng. Min. 4 6.48 3.57 ab ## 6 50% FPoulets + 50% Eng. Min. 4 10.8 2.70 b 6.2.12 Graphe avec les comparaisons ggplot(fruit1_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 12) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.3 Fruits 2 df &lt;- df_original 6.3.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit2)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.3.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit2) %&gt;% select(id, engrais, bloc, fruit2, is.outlier, is.extreme) df_out ## # A tibble: 2 x 6 ## id engrais bloc fruit2 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 2 Fumier porcs 1 24 TRUE FALSE ## 2 18 50% FPoulets + 50% Eng. Min. 3 43.2 TRUE TRUE Il y a une observation aberrante extrême. Exclue pour améliorer la distribution. df &lt;- df %&gt;% filter(id != 18) #filter(! id %in% df_out$id) 6.3.3 Le modèle ANOVA lm2 &lt;- lm(fruit2 ~ engrais, data = df) Anova(lm2) ## Anova Table (Type II tests) ## ## Response: fruit2 ## Sum Sq Df F value Pr(&gt;F) ## engrais 376.77 5 2.9331 0.03429 * ## Residuals 590.88 23 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À la semaine 5 après le repiquage, au moins deux types dengrais ont des effets significativement différents sur le Nombre de fruits des plants. Mais vérifions les conditions de validité de lANOVA. 6.3.4 Indépendance des résidus plot(lm2, 1) 6.3.5 Normalité des résidus plot(lm2, 2) shapiro_test(residuals(lm2)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm2) 0.986 0.960 6.3.6 Homogénéité des variances plot(lm2, 3) levene_test(residuals(lm2) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 23 1.01 0.434 On retient que la conclusion de lANOVA peut être considérée valide. Trouvons les engrais dont les effets sont différents. 6.3.7 Comparaisons par paires cm &lt;- multcomp::glht(lm2, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = fruit2 ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 6.108 ## Fumier poulets - Temoin == 0 1.918 ## Engrais mineral - Temoin == 0 6.980 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 7.034 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 11.359 ## Fumier poulets - Fumier porcs == 0 -4.190 ## Engrais mineral - Fumier porcs == 0 0.872 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.926 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 5.251 ## Engrais mineral - Fumier poulets == 0 5.062 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 5.116 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 9.441 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.054 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 4.379 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 4.325 ## Std. Error ## Fumier porcs - Temoin == 0 3.206 ## Fumier poulets - Temoin == 0 3.206 ## Engrais mineral - Temoin == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.400 ## Fumier poulets - Fumier porcs == 0 3.206 ## Engrais mineral - Fumier porcs == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 3.400 ## Engrais mineral - Fumier poulets == 0 3.206 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 3.400 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 3.206 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 3.400 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 3.400 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 1.905 0.4237 ## Fumier poulets - Temoin == 0 0.598 0.9901 ## Engrais mineral - Temoin == 0 2.177 0.2853 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 2.194 0.2778 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.341 0.0297 ## Fumier poulets - Fumier porcs == 0 -1.307 0.7781 ## Engrais mineral - Fumier porcs == 0 0.272 0.9998 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.289 0.9997 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 1.544 0.6405 ## Engrais mineral - Fumier poulets == 0 1.579 0.6193 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 1.596 0.6089 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 2.777 0.0975 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.017 1.0000 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 1.288 0.7882 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 1.272 0.7965 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 . ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 6.3.8 Graph des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 6.3.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;ab&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 6.3.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs ab ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 6.3.11 Associer les moyennes et les écart-types pour le rapport fruit2_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit2, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit2_moy, &quot;tab/fruit2_moyennes.csv&quot;) fruit2_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 10.4 7.18 a ## 2 Fumier porcs 5 16.5 4.45 ab ## 3 Fumier poulets 5 12.3 2.86 ab ## 4 Engrais mineral 5 17.4 4.56 ab ## 5 50% FPorcs + 50% Eng. Min. 5 17.4 6.47 ab ## 6 50% FPoulets + 50% Eng. Min. 4 21.8 2.73 b 6.3.12 Graphe avec les comparaisons ggplot(fruit2_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 25) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.4 Fruits 3 df &lt;- df_original 6.4.1 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = fruit3)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 6.4.2 Identification des échantillons aberrants et extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(fruit3) %&gt;% select(id, engrais, bloc, fruit3, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id engrais bloc fruit3 is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 15 Fumier poulets 3 11.2 TRUE FALSE ## 2 4 Engrais mineral 1 28 TRUE FALSE ## 3 17 50% FPorcs + 50% Eng. Min. 3 12 TRUE FALSE Il ny pas dobservation aberrante extrême. #df &lt;- df %&gt;% filter(! id %in% df_out$id) 6.4.3 Le modèle ANOVA lm3 &lt;- lm(fruit3 ~ engrais, data = df) Anova(lm3) ## Anova Table (Type II tests) ## ## Response: fruit3 ## Sum Sq Df F value Pr(&gt;F) ## engrais 606.08 5 2.0866 0.1023 ## Residuals 1394.25 24 Il ny aurait pas deffets significativement différents sur le Nombre de fruits des plants à cette date entre les types dengrais. Mais vérifions les conditions de validité de lANOVA. 6.4.4 Indépendance des résidus plot(lm3, 1) 6.4.5 Normalité des résidus plot(lm3, 2) shapiro_test(residuals(lm3)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm3) 0.943 0.112 6.4.6 Homogénéité des variances plot(lm3, 3) levene_test(residuals(lm3) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 1.00 0.437 On retient que la conclusion de lANOVA peut être considérée valide. Affichons quand même les comparaisons par paires. Autre tentative avec le non paramétrique : df %&gt;% kruskal_test(fruit3 ~ engrais) ## # A tibble: 1 x 6 ## .y. n statistic df p method ## * &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 fruit3 30 8.18 5 0.146 Kruskal-Wallis 6.4.7 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). cm &lt;- multcomp::glht(lm3, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) #summary(cm) 6.4.8 Graph des comparaisons #par(mar = c(0, 22, 0, 0)) #plot(cm) 6.4.9 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;a&quot; &quot;a&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;a&quot; &quot;a&quot; 6.4.10 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets a ## Engrais mineral Engrais mineral a ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. a ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. a 6.4.11 Associer les moyennes et les écart-types pour le rapport fruit3_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(fruit3, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(fruit3_moy, &quot;tab/fruit3_moyennes.csv&quot;) fruit3_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 16.6 3.62 a ## 2 Fumier porcs 5 23.7 11.2 a ## 3 Fumier poulets 5 19.6 5.11 a ## 4 Engrais mineral 5 21.5 4.01 a ## 5 50% FPorcs + 50% Eng. Min. 5 23.5 6.81 a ## 6 50% FPoulets + 50% Eng. Min. 5 31.1 11.0 a 6.4.12 Graphe avec les comparaisons ggplot(fruit3_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 35) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Nombre de fruits&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) 6.4.13 Évolution du nombre de fruits dans le temps selon le type dengrais df &lt;- df_original df &lt;- df %&gt;% gather(key = &quot;temps&quot;, value = &quot;fruit&quot;, fruit1, fruit2, fruit3) #%&gt;% #convert_as_factor(temps) df$temps[df$temps == &quot;fruit1&quot;] &lt;- &quot;52 JAR&quot; df$temps[df$temps == &quot;fruit2&quot;] &lt;- &quot;59 JAR&quot; df$temps[df$temps == &quot;fruit3&quot;] &lt;- &quot;66 JAR&quot; df &lt;- df %&gt;% convert_as_factor(temps) df_ic &lt;- summarySE(df, measurevar = &quot;fruit&quot;, groupvars = c(&quot;temps&quot;, &quot;engrais&quot;)) write_csv(df_ic, &quot;tab/fruit_moy_temps.csv&quot;) df_ic ## temps engrais N fruit sd se ci ## 1 52 JAR Temoin 5 6.168 6.115690 2.735020 7.593633 ## 2 52 JAR Fumier porcs 5 9.738 2.488739 1.112998 3.090177 ## 3 52 JAR Fumier poulets 5 7.712 2.587222 1.157041 3.212461 ## 4 52 JAR Engrais mineral 5 7.224 3.174828 1.419826 3.942069 ## 5 52 JAR 50% FPorcs + 50% Eng. Min. 5 8.880 6.201447 2.773372 7.700114 ## 6 52 JAR 50% FPoulets + 50% Eng. Min. 5 13.812 7.050023 3.152866 8.753759 ## 7 59 JAR Temoin 5 10.406 7.174621 3.208588 8.908468 ## 8 59 JAR Fumier porcs 5 16.514 4.450357 1.990260 5.525848 ## 9 59 JAR Fumier poulets 5 12.324 2.855176 1.276874 3.545169 ## 10 59 JAR Engrais mineral 5 17.386 4.560809 2.039656 5.662993 ## 11 59 JAR 50% FPorcs + 50% Eng. Min. 5 17.440 6.473589 2.895077 8.038022 ## 12 59 JAR 50% FPoulets + 50% Eng. Min. 5 26.052 9.872767 4.415235 12.258659 ## 13 66 JAR Temoin 5 16.614 3.619528 1.618702 4.494237 ## 14 66 JAR Fumier porcs 5 23.746 11.220654 5.018029 13.932282 ## 15 66 JAR Fumier poulets 5 19.554 5.105069 2.283056 6.338780 ## 16 66 JAR Engrais mineral 5 21.520 4.006495 1.791759 4.974720 ## 17 66 JAR 50% FPorcs + 50% Eng. Min. 5 23.534 6.813280 3.046991 8.459804 ## 18 66 JAR 50% FPoulets + 50% Eng. Min. 5 31.132 11.001051 4.919820 13.659609 ggplot(df_ic, aes(x = temps, y = fruit, colour = engrais, group = engrais)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Nombre de fruits&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "],["le-rendement-tomate.html", "Chapitre 7 Le rendement tomate 7.1 Préparation des données 7.2 Visualisation, boxplots 7.3 Identification des échantillons aberrants extrêmes", " Chapitre 7 Le rendement tomate 7.1 Préparation des données Jeu de données rdt.csv qui contient également les mesures des masses des tomates récoltées à la fin de culture. Le rendement est calculé pour les 4 plants centraux et cumule les 3 séances de récolte. rdt_tha : 116 JAS, 82 JAR, semaine 12 AR. La question est de savoir si les différents types dengrais induisent des rendements fruits significativement différents. df &lt;- read_csv(&quot;data/rdt.csv&quot;) ## ## -- Column specification -------------------------------------------------------- ## cols( ## bloc = col_double(), ## traitement = col_character(), ## engrais = col_character(), ## fleur1 = col_double(), ## fruit1 = col_double(), ## fleur2 = col_double(), ## fruit2 = col_double(), ## fleur3 = col_double(), ## fruit3 = col_double(), ## taux_fruit = col_double(), ## nfruits_re_m2 = col_double(), ## taux_nou_5 = col_double(), ## taux_nou_6 = col_double(), ## taux_nou_7 = col_double(), ## rdt_kgha = col_double(), ## rdt_tha = col_double() ## ) df &lt;- df %&gt;% mutate(id = 1:nrow(.), before = 1) %&gt;% select(id, bloc, traitement, engrais, rdt_tha) %&gt;% convert_as_factor(traitement, engrais) df$engrais &lt;- factor(df$engrais, levels = c(&quot;Temoin&quot;, &quot;Fumier porcs&quot;, &quot;Fumier poulets&quot;, &quot;Engrais mineral&quot;, &quot;50% FPorcs + 50% Eng. Min.&quot;, &quot;50% FPoulets + 50% Eng. Min.&quot;)) write_csv(df, &quot;tab/rdt_tha.csv&quot;) set.seed(123) df %&gt;% sample_n_by(bloc, size = 1) ## # A tibble: 5 x 5 ## id bloc traitement engrais rdt_tha ## &lt;int&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; ## 1 3 1 T2 Fumier poulets 1.69 ## 2 12 2 T5 50% FPoulets + 50% Eng. Min. 1.57 ## 3 15 3 T2 Fumier poulets 0.78 ## 4 20 4 T1 Fumier porcs 0.64 ## 5 26 5 T1 Fumier porcs 0.48 7.2 Visualisation, boxplots bxp &lt;- ggplot(df, aes(x = engrais, y = rdt_tha)) + geom_boxplot() + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Rendement t/ha&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) bxp 7.3 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(engrais) %&gt;% identify_outliers(rdt_tha) %&gt;% select(id, engrais, bloc, rdt_tha, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id engrais bloc rdt_tha is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 10 Engrais mineral 2 0.26 TRUE TRUE ## 2 29 50% FPorcs + 50% Eng. Min. 5 0.41 TRUE FALSE ## 3 18 50% FPoulets + 50% Eng. Min. 3 3.06 TRUE TRUE Il y a 2 observations aberrantes extrêmes mais qui ne sont pas exclues. #df &lt;- df %&gt;% filter(! id %in% c(10, 18)) 7.3.1 Le modèle ANOVA lm &lt;- lm(rdt_tha ~ engrais, data = df) Anova(lm) ## Anova Table (Type II tests) ## ## Response: rdt_tha ## Sum Sq Df F value Pr(&gt;F) ## engrais 3.3005 5 3.0729 0.02776 * ## Residuals 5.1555 24 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Il y aurait une différence significative entre les effets dau moins 2 engrais sur le rendement tomate. Mais vérifions les conditions de validité de lANOVA. 7.3.2 Indépendance des résidus plot(lm, 1) 7.3.3 Normalité des résidus plot(lm, 2) shapiro_test(rdt_tha, data = df) ## # A tibble: 1 x 3 ## variable statistic p ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 rdt_tha 0.846 0.000510 7.3.4 Homogénéité des variances plot(lm, 3) levene_test(residuals(lm) ~ engrais, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5 24 0.528 0.753 On retient que la conclusion de lANOVA peut être considérée valide : =&gt; différence deffet sur le rendement entre au moins deux engrais. df %&gt;% kruskal_test(rdt_tha ~ engrais) ## # A tibble: 1 x 6 ## .y. n statistic df p method ## * &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 rdt_tha 30 11.8 5 0.0382 Kruskal-Wallis df %&gt;% dunn_test(rdt_tha ~ engrais, p.adjust.method = &quot;bonferroni&quot;) %&gt;% select(group1, group2, p, p.adj, p.adj.signif) #%&gt;% ## # A tibble: 15 x 5 ## group1 group2 p p.adj p.adj.signif ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin Fumier porcs 0.914 1 ns ## 2 Temoin Fumier poulets 0.172 1 ns ## 3 Temoin Engrais mineral 1 1 ns ## 4 Temoin 50% FPorcs + 50% Eng. M~ 0.236 1 ns ## 5 Temoin 50% FPoulets + 50% Eng.~ 0.00874 0.131 ns ## 6 Fumier porcs Fumier poulets 0.141 1 ns ## 7 Fumier porcs Engrais mineral 0.914 1 ns ## 8 Fumier porcs 50% FPorcs + 50% Eng. M~ 0.196 1 ns ## 9 Fumier porcs 50% FPoulets + 50% Eng.~ 0.00633 0.0950 ns ## 10 Fumier poulets Engrais mineral 0.172 1 ns ## 11 Fumier poulets 50% FPorcs + 50% Eng. M~ 0.857 1 ns ## 12 Fumier poulets 50% FPoulets + 50% Eng.~ 0.209 1 ns ## 13 Engrais mineral 50% FPorcs + 50% Eng. M~ 0.236 1 ns ## 14 Engrais mineral 50% FPoulets + 50% Eng.~ 0.00874 0.131 ns ## 15 50% FPorcs + 50% Eng. M~ 50% FPoulets + 50% Eng.~ 0.151 1 ns #filter(p.adj.signif != &quot;ns&quot;) 7.3.5 Comparaisons par paires Tests post-hoc de multiples comparaisons par paires entre les groupes (ici, les engrais). tb_mc &lt;- (SNK.test(lm, &quot;engrais&quot;, group = TRUE))$groups %&gt;% mutate(engrais = rownames(.)) %&gt;% select(engrais, rdt_tha, groups) %&gt;% as_tibble() tb_mc ## # A tibble: 6 x 3 ## engrais rdt_tha groups ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 50% FPoulets + 50% Eng. Min. 1.62 a ## 2 Fumier poulets 1.14 ab ## 3 50% FPorcs + 50% Eng. Min. 0.948 ab ## 4 Engrais mineral 0.742 b ## 5 Fumier porcs 0.714 b ## 6 Temoin 0.672 b cm &lt;- multcomp::glht(lm, linfct = multcomp::mcp(engrais = &quot;Tukey&quot;)) summary(cm) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = rdt_tha ~ engrais, data = df) ## ## Linear Hypotheses: ## Estimate ## Fumier porcs - Temoin == 0 0.0420 ## Fumier poulets - Temoin == 0 0.4660 ## Engrais mineral - Temoin == 0 0.0700 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.2760 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.9500 ## Fumier poulets - Fumier porcs == 0 0.4240 ## Engrais mineral - Fumier porcs == 0 0.0280 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.2340 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.9080 ## Engrais mineral - Fumier poulets == 0 -0.3960 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.1900 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.4840 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.2060 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.8800 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.6740 ## Std. Error ## Fumier porcs - Temoin == 0 0.2931 ## Fumier poulets - Temoin == 0 0.2931 ## Engrais mineral - Temoin == 0 0.2931 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.2931 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 0.2931 ## Fumier poulets - Fumier porcs == 0 0.2931 ## Engrais mineral - Fumier porcs == 0 0.2931 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.2931 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 0.2931 ## Engrais mineral - Fumier poulets == 0 0.2931 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 0.2931 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 0.2931 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.2931 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 0.2931 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 0.2931 ## t value Pr(&gt;|t|) ## Fumier porcs - Temoin == 0 0.143 1.0000 ## Fumier poulets - Temoin == 0 1.590 0.6127 ## Engrais mineral - Temoin == 0 0.239 0.9999 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 0.942 0.9315 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 3.241 0.0361 ## Fumier poulets - Fumier porcs == 0 1.446 0.6995 ## Engrais mineral - Fumier porcs == 0 0.096 1.0000 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 0.798 0.9651 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 3.098 0.0492 ## Engrais mineral - Fumier poulets == 0 -1.351 0.7545 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 -0.648 0.9859 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 1.651 0.5749 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 0.703 0.9798 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 3.002 0.0606 ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 2.299 0.2331 ## ## Fumier porcs - Temoin == 0 ## Fumier poulets - Temoin == 0 ## Engrais mineral - Temoin == 0 ## 50% FPorcs + 50% Eng. Min. - Temoin == 0 ## 50% FPoulets + 50% Eng. Min. - Temoin == 0 * ## Fumier poulets - Fumier porcs == 0 ## Engrais mineral - Fumier porcs == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier porcs == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier porcs == 0 * ## Engrais mineral - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPoulets + 50% Eng. Min. - Fumier poulets == 0 ## 50% FPorcs + 50% Eng. Min. - Engrais mineral == 0 ## 50% FPoulets + 50% Eng. Min. - Engrais mineral == 0 . ## 50% FPoulets + 50% Eng. Min. - 50% FPorcs + 50% Eng. Min. == 0 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 7.3.6 Graphe des comparaisons par(mar = c(0, 22, 0, 0)) plot(cm) 7.3.7 Lettres pour différencier cld &lt;- multcomp::cld(cm) cld ## Temoin Fumier porcs ## &quot;a&quot; &quot;a&quot; ## Fumier poulets Engrais mineral ## &quot;ab&quot; &quot;ab&quot; ## 50% FPorcs + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. ## &quot;ab&quot; &quot;b&quot; 7.3.8 Les lettres dans un dataframe pour ggplot Le &lt;- cld$mcletters$Letters L &lt;- data.frame(engrais = levels(df$engrais), lettres = Le) L ## engrais lettres ## Temoin Temoin a ## Fumier porcs Fumier porcs a ## Fumier poulets Fumier poulets ab ## Engrais mineral Engrais mineral ab ## 50% FPorcs + 50% Eng. Min. 50% FPorcs + 50% Eng. Min. ab ## 50% FPoulets + 50% Eng. Min. 50% FPoulets + 50% Eng. Min. b 7.3.9 Associer les moyennes et les écart-types pour le rapport rdt_moy &lt;- df %&gt;% group_by(engrais) %&gt;% get_summary_stats(rdt_tha, type = &quot;mean_sd&quot;) %&gt;% select(-variable) %&gt;% mutate(lettres = L$lettres) write_csv(rdt_moy, &quot;tab/rend_moyennes.csv&quot;) rdt_moy ## # A tibble: 6 x 5 ## engrais n mean sd lettres ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin 5 0.672 0.429 a ## 2 Fumier porcs 5 0.714 0.211 a ## 3 Fumier poulets 5 1.14 0.424 ab ## 4 Engrais mineral 5 0.742 0.297 ab ## 5 50% FPorcs + 50% Eng. Min. 5 0.948 0.33 ab ## 6 50% FPoulets + 50% Eng. Min. 5 1.62 0.827 b 7.3.10 Graphe avec les comparaisons ggplot(rdt_moy, aes(x = engrais, y = mean)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 2) + theme_bw() + xlab(&quot;Engrais&quot;) + ylab(&quot;Rendement t/ha&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = lettres), vjust = -0.5, size = 4) "],["references.html", "References", " References "]]
